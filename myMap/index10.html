<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <script src="https://maps.googleapis.com/maps/api/js?sensor=false&libraries=geometry"></script>
<script type="text/javascript">
    var markers = [];
    var map;
    var time = 0;
    var locationS;
    var locationE;
    var rotationA;
    var markerCar;
    var markerIcon;
    var dr = true;
    var myInterval;
    var speed = 2100;
    var gillette = new google.maps.LatLng(44.288048282536,-105.52973217107834);
    var buffalo = new google.maps.LatLng(44.35093007155633,-106.68535656072677);
    var carIcon = {
      //url: 'car-side-solid.svg',
      //path: "M171.3 96H224v96H111.3l30.4-75.9C146.5 104 158.2 96 171.3 96zM272 192V96h81.2c9.7 0 18.9 4.4 25 12l67.2 84H272zm256.2 1L428.2 68c-18.2-22.8-45.8-36-75-36H171.3c-39.3 0-74.6 23.9-89.1 60.3L40.6 196.4C16.8 205.8 0 228.9 0 256V368c0 17.7 14.3 32 32 32H65.3c7.6 45.4 47.1 80 94.7 80s87.1-34.6 94.7-80H385.3c7.6 45.4 47.1 80 94.7 80s87.1-34.6 94.7-80H608c17.7 0 32-14.3 32-32V320c0-65.2-48.8-119-111.8-127zm-2.9 207c-6.6 18.6-24.4 32-45.3 32s-38.7-13.4-45.3-32c-1.8-5-2.7-10.4-2.7-16c0-26.5 21.5-48 48-48s48 21.5 48 48c0 5.6-1 11-2.7 16zM160 432c-20.9 0-38.7-13.4-45.3-32c-1.8-5-2.7-10.4-2.7-16c0-26.5 21.5-48 48-48s48 21.5 48 48c0 5.6-1 11-2.7 16c-6.6 18.6-24.4 32-45.3 32z",
      //scale: .04,
      path: "M17.402,0H5.643C2.526,0,0,3.467,0,6.584v34.804c0,3.116,2.526,5.644,5.643,5.644h11.759c3.116,0,5.644-2.527,5.644-5.644 V6.584C23.044,3.467,20.518,0,17.402,0z M22.057,14.188v11.665l-2.729,0.351v-4.806L22.057,14.188z M20.625,10.773 c-1.016,3.9-2.219,8.51-2.219,8.51H4.638l-2.222-8.51C2.417,10.773,11.3,7.755,20.625,10.773z M3.748,21.713v4.492l-2.73-0.349 V14.502L3.748,21.713z M1.018,37.938V27.579l2.73,0.343v8.196L1.018,37.938z M2.575,40.882l2.218-3.336h13.771l2.219,3.336H2.575z M19.328,35.805v-7.872l2.729-0.355v10.048L19.328,35.805z",
      scale: .7,
      strokeColor: '#9c9c9c',
      strokeWeight: .10,
      fillOpacity: 1,
      fillColor: 'yellow',
      offset: '100%',
      rotation: 0,
      anchor: new google.maps.Point(10, 10) // orig 10,50 back of car, 10,0 front of car, 10,25 center of car
    };

    var listLonLat = [
    [44.288048282536,-105.52973217107834],
    [44.35093007155633,-106.68535656072677],
    [44.29984375134257,-105.5276722345549],
    [44.31360213718502,-105.5276722345549],
    [44.33226907420168,-105.5276722345549],
    [44.342091392163574,-105.52629894353927],
    [44.36173109202789,-105.52492565252365],
    [44.3803827107887,-105.52904552557052],
    [44.39608473000302,-105.54140514471115],
    [44.41276351002209,-105.54552501775802],
    [44.41962986080725,-105.56200450994552],
    [44.43630192742683,-105.5661243829924],
    [44.44904794618952,-105.5716175470549],
    [44.46865177573721,-105.58947033025802],
    [44.47845122226672,-105.60045665838302],
    [44.492167682948775,-105.61281627752365],
    [44.50294263946165,-105.62242931463302],
    [44.51273632666183,-105.63478893377365],
    [44.52546565993122,-105.64165538885177],
    [44.53623446210162,-105.64989513494552],
    [44.549937330574366,-105.6595081720549],
    [44.562658534735746,-105.66774791814865],
    [44.57831158362274,-105.67324108221115],
    [44.60373880304865,-105.67186779119552],
    [44.61156032482789,-105.68834728338302],
    [44.62133574598316,-105.70208019353927],
    [44.632086808540535,-105.71031993963302],
    [44.64479004253448,-105.7144398126799],
    [44.658467338083284,-105.7199329767424],
    [44.672141408127004,-105.72267955877365],
    [44.684835870722566,-105.73366588689865],
    [44.69264646533141,-105.75151867010177],
    [44.699479871628,-105.77761119939865],
    [44.704360382417995,-105.80645031072677],
    [44.70338431317389,-105.83391613103927],
    [44.70533643520517,-105.86000866033615],
    [44.71216834392019,-105.8792347345549],
    [44.71607192970351,-105.89846080877365],
    [44.71607192970351,-105.91356700994552],
    [44.714120169725874,-105.9341663751799],
    [44.704360382417995,-105.94652599432052],
    [44.6965513676709,-105.95201915838302],
    [44.68874129968184,-105.96987194158615],
    [44.686788618115905,-105.9890980158049],
    [44.686788618115905,-106.00695079900802],
    [44.68874129968184,-106.02617687322677],
    [44.68971761577956,-106.06188243963302],
    [44.686788618115905,-106.08385509588302],
    [44.69167019860432,-106.10720104314865],
    [44.69264646533141,-106.12368053533615],
    [44.702408227472816,-106.14702648260177],
    [44.708264494824896,-106.16899913885177],
    [44.71314426505153,-106.18410534002365],
    [44.71314426505153,-106.20607799627365],
    [44.71216834392019,-106.22667736150802],
    [44.71704778500681,-106.24865001775802],
    [44.71314426505153,-106.2802357111174],
    [44.708264494824896,-106.30083507635177],
    [44.70338431317389,-106.31731456853927],
    [44.69752755211349,-106.33654064275802],
    [44.686788618115905,-106.34752697088302],
    [44.67311800399041,-106.3571400079924],
    [44.66042097414128,-106.3681263361174],
    [44.643812969427984,-106.37636608221115],
    [44.633064079125255,-106.38323253728927],
    [44.61840329242834,-106.39696544744552],
    [44.61156032482789,-106.41069835760177],
    [44.60471655086802,-106.41619152166427],
    [44.59396041976216,-106.42031139471115],
    [44.590048605674234,-106.4285511408049],
    [44.586136528288,-106.44091075994552],
    [44.57831158362274,-106.45739025213302],
    [44.57733339148729,-106.48073619939865],
    [44.574398716344746,-106.50270885564865],
    [44.570485585770555,-106.52330822088302],
    [44.56363697371089,-106.53566784002365],
    [44.54700127313576,-106.54528087713302],
    [44.53623446210162,-106.55352062322677],
    [44.51763255318325,-106.55352062322677],
    [44.50588091840333,-106.55352062322677],
    [44.49118804271594,-106.55901378728927],
    [44.48530985575947,-106.56450695135177],
    [44.47649146460131,-106.56450695135177],
    [44.46277131797895,-106.56313366033615],
    [44.45296923865492,-106.57411998846115],
    [44.43728248913677,-106.58647960760177],
    [44.428456841381376,-106.59609264471115],
    [44.41472540680415,-106.60158580877365],
    [44.40197190123568,-106.60845226385177],
    [44.39608473000302,-106.6208118829924],
    [44.37940119472848,-106.63042492010177],
    [44.36958512915999,-106.64415783025802],
    [44.35583987312121,-106.6537708673674],
    [44.35191206477657,-106.66338390447677],
    [44.35093007155633,-106.68535656072677],
    ]

    window.onload = function () {
        var mapOptions = {
            center: new google.maps.LatLng(44.699479871628,-105.77761119939865),
            zoom: 5,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        map = new google.maps.Map(document.getElementById("dvMap"), mapOptions);
    };
    
    function DeleteMarkers() {
        //Loop through all the markers and remove
        for (var i = 0; i < markers.length - 1; i++) {
            markers[i].setMap(null);
            markers.unshift();
        }
        //markers = [];
    };

    function DeleteAllMarkers() {
        //Loop through all the markers and remove
        for (var i = 0; i < markers.length; i++) {
            markers[i].setMap(null);
        }
        markers = [];
    };

    function setCarIcon(locationS, locationE) {
      carIcon.rotation = google.maps.geometry.spherical.computeHeading(locationS, locationE);//180 - heading;
      var marker1 = new google.maps.Marker({
        position: locationS,
        map: map,
        draggable: false,
        icon: carIcon
      });

      markers.push(marker1);

      if(markers.length > 0){
        DeleteMarkers();
      }
    }

    function setPosition(){

        if(time <= 0){
            dr = true;
        }else if(time >= listLonLat.length - 1){
            dr = false;
        }

        if(dr){
            locationS = new google.maps.LatLng(listLonLat[time][0], listLonLat[time][1]);
            locationE = new google.maps.LatLng(listLonLat[time + 1][0], listLonLat[time + 1][1]);
            setCarIcon(locationS, locationE);
            time ++;
        }
        else {
            locationS = new google.maps.LatLng(listLonLat[time][0], listLonLat[time][1]);
            locationE = new google.maps.LatLng(listLonLat[time - 1][0], listLonLat[time - 1][1]);
            
            setCarIcon(locationS, locationE);

            time --;
        }
    };

    myInterval = setInterval(setPosition, speed);

    var range = document.getElementById('range');
    function setValue(value1){
        clearInterval(myInterval);
        myInterval = setInterval(setPosition, speed - value1);
    };
</script>
</head>
<body>
<div id="dvMap" style="width: 100%; height: 500px">
</div>
<div>
    <input id="range" type="range" min="200" max="2000" step="1" value="300" oninput="setValue(this.value)">
</div>
<br />
</body>
</html>